\documentclass{trlnotes}
\setlayout{hardcopy}
\usepackage{silence}
\WarningFilter{latex}{Reference}
\graphicspath{{../../img/}}

\begin{document}
    \paragraph{Интегральное уравнение II рода, метод замены ядра на вырожденное}

    \begin{de}
        \ti{Интегральным уравнением Фредгольма II рода} называется уравнение вида
        \begin{equation} \label{eq:fred2}
            \varphi(x) = f(x) + \mu \int\limits_a^b K(x, \, t) \varphi(t) \, \del t.
        \end{equation}
        Функция $K$~--- его \ti{ядро}, а $\mu$~--- \ti{характеристическое число}.\footnote{Кажется, иногда в определении полагают $\mu = 1$, но всегда ведь можно внести его в ядро.}
    \end{de}

    Обозначим через $K$ (хм, да, вольность) оператор 
    \[
        \varphi(t) \mapsto \int\limits_a^b K(x, \, t) \varphi(t) \, \del t.
    \]
    Ясно, что он компактен. Уравнение теперь примет вид
    \[
        (I - \mu K)\varphi = f.
    \]
    Оператор $T = I - \mu K$, конечно, фредгольмов.

    \begin{st}
        Сопряжённый в $L^2\big([a, \, b]\big)$ оператор к $K$ выражается следующим образом:
        \[
            K^* \varphi(x) = \int\limits_a^b \ov{-}{K(t, \, x)} \varphi(t) \, \del t.
        \]
        \begin{proof}
            Прямым вычислением (ну, там внутри ещё теорема Фубини) проверяется, что 
            \[
                \langle K \varphi, \, \psi \rangle = \langle \varphi, \, K^{*} \psi \rangle.
            \]
        \end{proof}
    \end{st}

    \begin{rem}
        У ядра меняются местами аргументы и оно сопрягается~--- точно так же, как транспонирование вместе с комплексным сопряжением дают матрицу сопряжённого оператора в конечномерном случае!
    \end{rem}

    Сформулируем альтернативу Фредгольма \ref{thm:fred-alt} для такого уравнения:

    \begin{st}
        $\hphantom{.}$
        \begin{enumerate}
            \item Уравнение $T\varphi = f$ разрешимо однозначно тогда и только тогда, когда $\mu^{-1}$~--- не собственное число оператора $K$.
            \item В противном случае уравнение $T \varphi = f$ разрешимо тогда и только тогда, когда функция $f$ ортогональна всем собственным векторам оператора $K^*$, соответствующим числу $\ov{-}{\mu}^{-1}$.
            \item $\mu^{-1}$ и $\ov{-}{\mu}^{-1}$~--- собственные числа операторов $K$ и $K^*$ соответственно одинаковой конечной кратности.
        \end{enumerate}
    \end{st}

    \begin{rem}
        Для симметричного ядра (т.е. когда $K = K^*$) то же самое несложно доказать, используя разложение по собственному базису оператора $K$ (которое есть по теореме Гильберта-Шмидта \ref{thm:hilb-sch}). Так можно быстро понять, что если $\mu^{-1}$~--- собственное число $K$, то решений либо нет, либо их бесконечно много.
    \end{rem}

    Рассмотрим уравнение \ref{eq:fred2} с вырожденным ядром
    \[
        K(x, \, t) = \sum\limits_{i = 1}^n \alpha_i(x) \beta_i(t).
    \]
    Функции $\alpha_i$ и $\beta_i$ можно считать ЛНЗ: если это не так, нетрудно выразить одну из них через другие и избавиться от неё. Подставляя ядро в уравнение \ref{eq:fred2}, получим

    \begin{equation}\label{eq:deg-ker-repr}
        \varphi(x) = f(x) + \sum\limits_{j = 1}^n A_j \alpha_i(x), \text{ где } A_j = \mu \int\limits_a^b \beta_j(t) \varphi(t) \, \del t.
    \end{equation}

    Это представление для функции $\varphi$ теперь подставим в исходное уравнение:

    \[
        f(x) + \sum\limits_{i = 1}^n A_i \alpha_i(x) = f(x) + \mu \int\limits_a^b \sum\limits_{i = 1}^n \alpha_i(x) \beta_i(t) \left(f(t) + \sum\limits_{j = 1}^n A_j \alpha_j(t) \right) \, \del t
    \]
    Чтобы переписать это покороче, введём обозначения
    \[
        \beta_{ij} = \int\limits_a^b \beta_i(t) \alpha_j(t) \, \del t, \quad f_i = \int\limits_a^b f(t) \beta_i(t) \, \del t.
    \]
    и получим
    \[
        \sum\limits_{i = 1}^n A_i \alpha_i(x) = \mu \sum\limits_{i = 1}^n \left(f_i + \sum\limits_{j = 1}^n \beta_{ij} A_j \right) \alpha_i(x).
    \] 
    Поскольку $\alpha_i$ линейно независимы, коэффициенты при них слева и справа должны быть равны. Записав эти равенства, мы приходим к системе линейных уравнений
    \[
        A_i = \mu f_i + \mu \sum\limits_{j = 1}^n \beta_{ij} A_j .
    \]
    В векторном виде она будет выглядеть так:
    \[
        A = \mu (\beta A + f),
    \]
    где $A$ и $f$~--- векторы, $\beta$~--- матрица, а $\mu$ всё ещё число.

    Эта система решается так:
    \[
        (I - \mu \beta) A = \mu f \so \boxed{A = \mu (I - \mu \beta)^{-1} f}\,, \text{ если } \det (I - \mu \beta) \neq 0.
    \]

    Пусть $\Delta = \det(I - \mu \beta)$ и $\Delta_{ij}$~--- алгебраическое дополнение элемента $\delta_{ij} - \mu \beta_{ij}$. Тогда можно записать явную формулу для $A$\footnote{Это просто формула для обратной матрицы через алгебраические дополнения.}:
    \[
        A_{i} = \dfrac{\mu}{\Delta} \sum\limits_{j = 1}^n \Delta_{ji} f_j
    \]
    Подставляя теперь найденные $A_i$ в \ref{eq:deg-ker-repr}, найдём, что
    \[
        \varphi(x) = f(x) + \lambda \int\limits_a^b \Gamma(x, \, t) f(t) \, \del t,
    \]
    где \ti{резольвента} $\Gamma$ имеет вид
    \[
        \Gamma(x, \, t) = \dfrac{1}{\Delta} \sum\limits_{i, \, j = 1}^n \Delta_{ji} \alpha_i(x) \beta_j(s).
    \]

    Трудная задача~--- приблизить произвольное ядро вырожденным. Есть несколько способов:

    \begin{enumerate}
        \item Разложить ядро в ряд Тейлора.
        \item Интерполировать ядро.
        \item Разложить ядро по ортогональной системе функций.
    \end{enumerate}


    Подробнее про них можно прочитать в книге \cite{comp-krilov-2}.

    Заменяя ядро на вырожденное, мы надеемся, что и решения тоже изменятся не сильно. Надо бы это обосновать (хотя бы как-то). Пусть есть уравнение
    \[
        Au = f, \quad A = I - K
    \]
    и приближающее его уравнение
    \[
        A_n u_n = f, \quad A_n = I - K_n. 
    \]
    Нетрудно видеть, что
    \[
        u - u_n = (A^{-1} - A_n^{-1})f \so \|u - u_n\| \leqslant \big\|A^{-1} - A_n^{-1}\big\| \cdot \|f\|.
    \]
    Поэтому интересно оценить норму разности обратных операторов. Займёмся этим.

    \begin{st}\label{st:close-zero-inv}
        Пусть $P$~--- ограниченный оператор, $\|P\| < 1$. Тогда оператор $I - P$ обратим, причём
        \[
            (I - P)^{-1} = \sum\limits_{i = 1}^{\infty} P^n,
        \]
        где сходимость~--- по операторной норме.
    \end{st}

    \begin{st} \label{st:close-inv}
        Пусть $P$ и $H$~--- ограниченные операторы, $P$ обратим, а $\|H\| < \|P^{-1}\|^{-1}$. Тогда элемент $P - H$ обратим, причём
        \[
            \big\| \, (P - H)^{-1}\big\|  \leqslant \dfrac{\|P^{-1}\|}{1 - \|H\| \, \|P^{-1}\|}. 
        \]
        и
        \[
            \big\| \, (P - H)^{-1} - P^{-1}\big\| \leqslant \dfrac{\|H\| \, \|P^{-1}\|^2}{1 - \|H\| \, \|P^{-1}\|}.
        \]
        \begin{proof}
            Позволим себе иногда использовать дроби и $1$ вместо $I$, как если бы операторы были числами. Не составит труда переписать всё через обратные!

            Заметим, что первое из двух утверждений теоремы для $P = I$ следует из \ref{st:close-zero-inv}:
            \begin{equation}\label{eq:close-zero-inv}
                \big\| \, (I - H)^{-1}\big\| = \left \| \, \sum\limits_{i = 1}^{\infty} H^n \, \right\| \leqslant \sum\limits_{i = 1}^{\infty} \|H\|^n = \dfrac{1}{1 - \|H\|}.
            \end{equation}

            Далее,
            \[
                \left\|\, \dfrac{1}{P - H} \,\right \| = \left\|\, P^{-1} \dfrac{1}{1 - P^{-1}H} \,\right \| \leqslant \|P^{-1}\| \cdot \left\|\,\dfrac{1}{1 - P^{-1}H} \,\right \| \leqslant \dfrac{\|P^{-1}\|}{1 - \|P^{-1}H\|} \leqslant \dfrac{\|P^{-1}\|}{1 - \|H\| \, \|P^{-1}\|}.
            \]
            В предпоследнем переходе используется соотношение \ref{eq:close-zero-inv}, где $H \to P^{-1}H$.

            Наконец,
            \[
                \left\|\, \dfrac{1}{P - H} - \dfrac{1}{P}\,\right \| = \left\|\, \dfrac{1}{P}\left(\dfrac{1}{1 - P^{-1}H} - 1 \right)\right \| =  \left\|\, \dfrac{1}{P} \, \dfrac{P^{-1}H}{1 - P^{-1}H} \right \| \leqslant \dfrac{\|H\| \, \|P^{-1}\|^2}{1 - \|H\| \, \|P^{-1}\|}.
            \]
        \end{proof}
    \end{st}

    Отсюда сразу же следует утверждение

    \begin{st}\label{st:dif-inv}
        При достаточно больших $n$
        \[
            \big\|A^{-1} - A_n^{-1}\big\| \leqslant \dfrac{\rho \, \|A^{-1}\|^2}{1 - \rho \, \|A^{-1}\|} \text{ и } \big\|A^{-1} - A_n^{-1}\big\| \leqslant \dfrac{\rho \, \|A_n^{-1}\|^2}{1 - \rho \, \|A_n^{-1}\|},
        \]
        где $\rho = \|A - A_n\| = \|K - K_n\|$.
    \end{st}

    \begin{rem}
        Рассмотрим теперь задачу с симметричным ядром (т.е. с самосопряжённым $K$). В ней есть ортонормированный собственный базис $\alpha_i$, поэтому
        \[
            u = \sum\limits_{i = 1}^{\infty} \langle u, \, \alpha_i \rangle \alpha_i \so Ku = \sum\limits_{i = 1}^{\infty} \langle u, \, \alpha_i \rangle \lambda_i \alpha_i,
        \]
        где $\lambda_i$~--- соответствующее собственное число. Расположим $\lambda_i$ в порядке убывания модуля и положим
        \[
            K_n u = \sum\limits_{i = 1}^{n} \langle u, \, \alpha_i \rangle \lambda_i \alpha_i
        \]
        Это интегральный оператор с вырожденным ядром
        \begin{equation}\label{eq:eig-deg-ker}
            K_n(x, \, t) = \sum\limits_{i = 1}^n \lambda_i \alpha_i(x) \ov{-}{\alpha_i(t)}.
        \end{equation}

        %unsure
        Можно доказать, что он является лучшей аппроксимацией ранга $n$ для оператора $K$ по операторной $L^2$-норме.
        %unsure

        Посмотрим на разность:
        \[
            (K - K_n)u = \sum\limits_{i = n+1}^{\infty} \langle u, \, \alpha_i \rangle \lambda_i \alpha_i.
        \]
        Найдём её норму:
        \[
            \big\|(K - K_n)u \,\big\|^2 = \sum\limits_{i = n + 1}^{\infty} |u_i|^2 \, |\lambda_i|^2, \quad u_i = \langle u, \, \alpha_i \rangle.
        \]
        При этом
        \[
            \|K - K_n\| = \sup \dfrac{\big\|(K - K_n)u \,\big\|}{\|u\|},
        \]
        и
        \[
            \dfrac{\big\|(K - K_n)u \,\big\|^2}{\|u\|^2} = \dfrac{\sum\limits_{i = n + 1}^{\infty} |u_i|^2 \, |\lambda_i|^2}{\sum\limits_{i = n + 1}^{\infty} |u_i|^2} \leqslant \dfrac{\sum\limits_{i = n + 1}^{\infty} |u_i|^2 \, |\lambda_{n + 1}|^2}{\sum\limits_{i = n + 1}^{\infty} |u_i|^2} = |\lambda_{n+1}|^2.
        \]
        С другой стороны, эта оценка достигается, когда $u$~--- собственный вектор числа $\lambda_{n+1}$. Поэтому
        \[
            \boxed{\|K - K_n\| = |\lambda_{n + 1}|} \, .
        \]
        Отсюда и из утверждения \ref{st:dif-inv} ясно: чем быстрее убывают собственные числа, тем лучше наша оценка! 
        %unsure
        Из уравнения \ref{eq:eig-deg-ker} видно, что собственные числа~--- что-то вроде коэффициентов в ряде Фурье по собственным функциям для ядра. Видимо, поэтому скорость их убывания возрастает, если ядро становится более гладким... А ядра гладкие не всегда.
        %unsure
    \end{rem}

    \begin{rem}
        Есть способ сгладить ядро. Надо в уравнение \ref{eq:fred2} подставить
        \[
            \varphi(t) = f(t) + \mu\int\limits_a^b K(t, \, \xi) \varphi(\xi) \, \del \xi.
        \]
        Получится уравнение
        \[
            \varphi(x) = f_2(x) + \mu\int\limits_a^b  K_2(x, \xi) \varphi(\xi) \, \delta \xi,
        \]
        где
        \[
            f_2(x) = f(x) + \mu \int\limits_a^b K(x, \, t) f(t) \, \del t, \quad K_2(x, \, \xi) = \mu \int\limits_a^b K(x, \, t) K(t, \, \xi) \, \del t. 
        \]
        У $K_2$ с гладкостью получше, но его надо считать.
    \end{rem}

    \paragraph{Метод квадратур для интегрального уравнения}

    Идея заключается в том, чтобы в уравнении
    \[
        u(x) = f(x) + \int\limits_a^b K(x, \, t) u(t)\, \del t
    \]
    заменить интегрирование на вычисление по какой-нибудь квадратурной формуле:
    \[
        \int\limits_a^b u (x) \, \del x = \sum\limits_{k = 1}^n A_k u(x_k) + R.
    \]
    Получится
    \[
        u(x) = f(x) + \sum\limits_{k = 1}^n A_k K(x, \, x_k) u(x_k) + R.
    \]
    Пусть $\tilde{u}$~--- решение этого уравнения с отброшенным $R$, $u_k = \tilde{u}(x_k)$, $f_k = f(x_k)$ и $K_{ik} = K(x_i, \, x_k)$.
    Получаем систему линейных уравнений
    \[
        u_i = f_i + \sum\limits_{k = 1}^n A_k K_{ik} u_k.
    \]
    Её можно решить обычными методами; зная $u_k$, можно оценить $u(x)$ в любой точке:
    \[
        u(x) = f(x) + \sum\limits_{k = 1}^n A_k K(x, \, x_k) u_k.
    \]

    Попробуем оценить погрешность результата. Для многих стандартных квадратурных методов верна формула
    \[
        R[\theta] = \delta(n) \max |\theta^{(m)}(x)|.
    \]
    Нас интересует $R\big[K(x, \, t)u(t)\big]$ при фиксированном $x$. $m$-е производные функции $K(x, \, t)u(t)$ выражаются через производные известной $K(x, \, t)$ и через производные $u(t)$ порядка не более $m$.

    Чтобы оценить их, продифференцируем наше интегральное уравнение:
    \[
        u^{(l)}(x) = f^{(l)}(x) + \int\limits_a^b K^{(l)}_x(x, \, t) u(t)\, \del t.
    \]
    Отсюда можно найти оценку для $u^{(l)}$ через известные $f$ и $K$ и максимум модуля решения. Решение же можно записать, как
    \[
        u = (I - K)^{-1} f \so \|u\| \leqslant \big\|(I - K)^{-1}\big\| \cdot \|f\| \leqslant \dfrac{\|f\|}{1 - \|K\|} \leqslant \dfrac{\|f\|}{1 - \varkappa},
    \]
    где 
    \[
        \varkappa = (b - a) \max \big|K(s, \, t)\big|.
    \]
    Предпоследний переход обусловлен утверждением \ref{st:close-inv}. 

    \begin{rem}
        Во-первых, сейчас у нас все нормы~--- $L^1$, от этого ничего не портится. Во-вторых, мы только что неявно предположили, что $|\varkappa| < 1$.
    \end{rem}

    Получив оценку для модуля решения, мы можем найти оценку
    \[
        \left|\dfrac{\pd^{m}}{\pd t^m} \big(K(x, \, t) u(t)\big)\right| \leqslant M,
    \]
    зависящую только от известных функций.

    Перейдём теперь непосредственно к оценке ошибки. У нас есть два уравнения 
    \begin{align*}
        Au &= f, \quad A = I - K; \\
        \tilde{A} \tilde{u} &= f, \quad \tilde{A} = I - \tilde{K},
    \end{align*}
    где 
    \[
        \tilde{K}\varphi(x) = \sum\limits_{i = 1}^n A_i K(x, \, x_i) \varphi(x_i).
    \]
    Заметим, что
    \[
        \tilde{A}(u - \tilde{u}) = \tilde{A}u - Au \so \|u - \tilde{u}\| \leqslant \boxed{\|\tilde{A}^{-1}\| \, \|\tilde{A}u - Au\|}\,.
    \]
    Оценим норму $\tilde{A}^{-1}$. Для этого сначала оценим норму $\tilde{K}$:
    \[
        \left | \, \sum\limits_{i = 1}^n A_i K(x, \, x_i) \varphi(x_i) \right | \leqslant \max |K| \cdot \|\varphi\| \cdot \sum\limits_{i = 1}^n A_i = (b - a) \max |K| \cdot \|\varphi\|,
    \]
    поэтому $\|\tilde{K}\| \leqslant \varkappa$.

    Отсюда
    \[
        \|\tilde{A}^{-1}\| = \big\|(I - \tilde{K})^{-1}\big\| \leqslant \dfrac{1}{1 - \varkappa}.
    \]
    Теперь оценим $\|\tilde{A}u - Au\|$:
    \[
        \|\tilde{A}u - Au\| = \max \bigg|R\big[K(x, \, t) u(t)\big]\bigg| \leqslant M\delta(n).
    \]
    В конечном итоге находим
    \[
        \boxed{\|u - \tilde{u}\| \leqslant \dfrac{M\delta(n)}{1 - \varkappa}}\,.
    \]

    Подробнее про этот метод можно прочитать в книгах \cite{gavurin} и \cite{comp-krilov-2}.

    \paragraph{Вариационный принцип для ограниченного оператора; метод Ритца для интегрального уравнения II рода}

    \begin{rem}
        В этом параграфе все гильбертовы пространства вещественны.
    \end{rem}

    Основная идея заключается в том, чтобы свести решение уравнения
    \[
        Au = f
    \]
    к минимизации некоторого функционала. 

    \begin{de}
        \ti{Энергетическим} функционалом для такого уравнения называется
        \[
            \tilde{f}(u) = ( Au, \, u ) - 2(f, \, u).
        \]
    \end{de}

    Чтобы работать с энергетическим функционалом, нужны дополнительные ограничения на оператор $A$.

    \begin{de}
        Оператор $A$ называют \ti{положительно определённым}, если $(Au, \, u) \geqslant k^2 (u, \, u)$\footnote{Это необычное название, кажется. Их называют ещё \ti{полуограниченными снизу}.}.
    \end{de}

    \begin{st} \label{st:semi-bound-inv}
        Самосопряжённый положительно определённый оператор $A$ обратим.
        \begin{proof}
            Положим в доказательстве $k^2 = 1$, ибо на обратимость это не влияет, можно просто разделить $A$ на $k^2$. Заметим, что $\ker A = \{0\}$, поскольку
            \[
                Au = 0 \so (Au, \, u) = 0 \so (u, \, u) = 0 \so u = 0.
            \]
            При этом ортогональное дополнение образа $A$~--- его ядро:
            \[
                x \in \im A^{\perp} \eqv \all u \quad 0 = (x, \, Au) = (Ax, \, u) \eqv Ax = 0.
            \]
            Поэтому
            \[
                \ov{-}{\im A} = \ker A^{\perp} = H,
            \]
            и образ оператора $A$ плотен в $H$.

            Докажем, что он на самом деле равен $H$. Для этого нам пригодится неравенство
            \[
                \|u\|^2 \leqslant (Au, \, u) \leqslant \|Au\| \, \|u\| \so \boxed{\|u\| \leqslant \|Au\|}\,.
            \]
            Пусть $y \in H$. Поскольку образ плотен, найдётся последовательность $\{x_n\}$ такая, что $Ax_n \to y$. Однако
            \[
                \|x_n - x_m\| \leqslant \|Ax_n - Ax_m\|,
            \]
            поэтому $\{x_n\}$ сходится в себе; гильбертово пространство полно, поэтому $x_n \to x$. Но оператор $A$ непрерывен, и
            \[ 
                x_n \to x \so A x_n \to Ax \so Ax = y.
            \]
            Таким образом, $A$ сюръективен, и у него есть теоретико-множественный обратный.

            При этом
            \[
                \|A^{-1}y\| \leqslant \|y\|, 
            \]
            поэтому обратный оператор ограничен.


        \end{proof}
    \end{st}

    \begin{st}
        Если $A$~--- самосопряжённый и положительно определённый, то существует единственное решение $u^*$ уравения $Au = f$, которое совпадает с единственным минимумом энергетического функционала.
        \begin{proof}
            Существование и единственность решения следуют из обратимости оператора. Посчитаем значение функционала на векторе $u^* + h$:
            \begin{align*}
                \tilde{f}(u^* + h) &= \big(A(u^* + h), \, u^* + h\big) - 2(f, \, u^* + h) =  \tilde{f}(u^*) + (Au^*, \, h) + (Ah, \, u^*) + (Ah, \, h) - 2(f, \, h) = \\ &= \tilde{f}(u^*) + (h, \, f) - (f, \, h) + (Ah, \, h).
            \end{align*}
            Мы считаем всё вещественным, поэтому $(h, \, f) = (f, \, h)$ и
            \[
                \tilde{f}(u^* + h) = \tilde{f}(u^*) + (Ah, \, h) \geqslant \tilde{f}(u^*).
            \]
        \end{proof}
    \end{st}

    Метод Ритца устроен примерно так:
    \begin{enumerate}
        \item Выбрать в пространстве $H$ линейно независимый набор $\{\varphi_k\}$.
        \item Рассмотреть конечномерное подпространство $H_n$, натянутое на первые $n$ векторов базиса.
        \item Найти в нём минимум функционала $\tilde{f}$ и считать его приближением.
    \end{enumerate}

    Минимум в $H_n$ будем искать в виде
    \[
        u_n = \sum\limits_{k = 1}^n c_k \varphi_k.
    \]

    \begin{st}
        Координаты $c_n$ минимума $\tilde{f}$ в подпространстве $H_n$ находится из системы линейных уравнений
        \[
            \sum\limits_{k = 1}^n (A \varphi_k, \, \varphi_i) \, c_n = (f, \, \varphi_i)
        \]
        \begin{proof}
            Если подставить 
            \[
                u_n = \sum\limits_{k = 1}^n c_k \varphi_k
            \]
            в формулу для функционала
            \[
                \tilde{f}(u_n) = ( Au_n, \, u_n ) - 2(f, \, u_n),
            \]
            получится
            \[
                \tilde{f}(u_n) = \sum\limits_{k, \, m} c_k c_m (A\varphi_k, \, \varphi_m) - 2\sum\limits_m c_m (f, \, \varphi_m).
            \]
            Дифференцируя это выражение по $c_i$ и приравнивая к нулю, получим нужную СЛУ.
        \end{proof}
    \end{st}

    \begin{rem}
        Симметричная матрица $a_{ij} = (A\varphi_i, \, \varphi_j)$~--- матрица Грама положительно определённой симметрической билинейной формы $g(u, \, v) = (Au, \, v)$. Известно, что определитель матрицы Грама равен квадрату объёма параллелипипеда, натянутого на базисные вектора, в соответствующей метрике. Он, конечно, ненулевой, а потому система линейных уравнений разрешима однозначно.
    \end{rem}

    Поговорим о сходимости метода Ритца.

    \begin{st}\label{st:rietz-conv-1}
        Если набор $\{\varphi_k\}$ таков (это по сути означает, что он является базисом), что
        \[
            \all v \in H \quad \all \varepsilon > 0 \quad \ex n, \, \alpha_i \, \col \; \left\|v - \sum\limits_{i = 1}^n \alpha_i \varphi_i \right\| < \varepsilon,
        \]
        то метод Ритца сходится, т.е. $\|u_n - u^*\| \to 0$.
        \begin{proof}
            Поскольку оператор $A$ положительно определён, форма $g(u, \, v) = (Au, \, v)$ является настоящим скалярным произведением. Мы утверждаем, что $u_n$~--- элемент из $H_n$, ближайший к $u^*$ с точки зрения метрики $g$. Докажем это. Для этого предположим, что
            \[
                u_n = v_n + h,
            \]
            где $v_n = u^* - v_n^{\perp}$~--- ближайший к $u^*$ элемент из $H_n$, а $v_n^{\perp} \perp H_n$. Тогда
            \begin{align*}
                \tilde{f}(u_n) &= \tilde{f}(u^*) + \big(A(h - v_n^\perp), \, h - v_n^\perp\big) = \\ &= \tilde{f}(u^*) + g(v_n^{\perp}, \, v_n^{\perp}) + g(h, \, h).
            \end{align*}
            Видно, что это выражение минимально, когда $h = 0$ и $u_n = u^* - v_n^{\perp}$.

            Найдём теперь по $\varepsilon$ такое $N$ и $w \in H_N$, что $\|w - u^*\| < \varepsilon$. Тогда
            \[
                \|u_n - u^*\| \leqslant \dfrac{1}{k} \, \|u_n - u^*\|_A \leqslant \dfrac{1}{k} \|w - u^*\|_A \leqslant \dfrac{\sqrt{\|A\|}}{k} \|w - u^*\| < \dfrac{\sqrt{\|A\|}}{k} \varepsilon,
            \]
            где $\|x\|_A = \sqrt{g(x, \, x)}$. Объясним переходы по пунктам:
            \begin{enumerate}
                \item Потому что $g(x, \, x) \geqslant k^2 (x, \, x)$.
                \item Потому что $u_n$~--- самый близкий элемент к $u^*$.
                \item Потому что $(Ax, \, x) \leqslant \|Ax\| \, \|x\| \leqslant \|A\| \, (x, \, x)$.
                \item Прост)00
            \end{enumerate}
            Эпсилон домножился на константу, но это не страшно: стремление к нулю всё равно есть.
        \end{proof}
    \end{st}

    \begin{rem}
        Видно, что скорость сходимости метода от гладкости ядра не зависит (только от его нормы). По сути она определяется тем, насколько быстро убывают коэффициенты разложения $u^*$ по базису $\varphi_k$, что связано с гладкостью решения. Зато ограничения на оператор сильные.
    \end{rem}

    \paragraph{Интегральное уравнение I рода и его некорректность}

    \begin{de}
        \ti{Интегральным уравнением I рода} называют уравнение вида
        \[
            \int\limits_a^b K(x, \, t) u(t) \, \del t = f(x).
        \]
    \end{de}

    \begin{de}
        Говорят, что задача \ti{корректна}, если при малых изменениях исходных данных решение меняется слабо.
    \end{de}

    \begin{de}
        Задачу вида $Au = f$ называют \ti{корректной}, если у оператора $A$ есть ограниченный обратный.
    \end{de}

    Кажется, эти два определения почти одинаковые. :)

    \begin{st}
        Задача о решении уравнения Фредгольма I рода некорректна.
        \begin{proof}
            Интуитивно это понятно: мы решаем уравнение вида $Ku = f$, где $K$~--- компактный оператор. Его образ маленький, и логично, что слегка изменив $f$ мы можем получить задачу с совсем другим решением или, скорее, вовсе неразрешимую. 

            Покажем это для случая симметричного ядра. Симметричность позволит нам выбрать собственный базис $\{\varphi_n\}$ с собственными числами $\lambda_n$. Пусть
            \[
                u = \sum u_i \varphi_i; \quad u = \sum f_i \varphi_i.
            \]
            Тогда уравнение перепишется, как
            \[
                \sum u_i \lambda_i \varphi_i = \sum f_i \varphi_i \eqv \boxed{u_i \lambda_i = f_i}\,.
            \]
            Формально решение имеет вид
            \[
                u = \sum\limits_{i = 1}^{\infty} \dfrac{f_i}{\lambda_i}\varphi_i.
            \]
            Если $\lambda_i = 0$, а $f_i \neq 0$, то задача наверняка не имеет решения. Всё плохо, даже если это не так: известно, что собственные числа компактного оператора стремятся к нулю, поэтому ряд для $u$ будет сходиться, только если $f_i$ убывают ещё быстрее.

            Посмотрим, что будет при небольшом изменении начальных данных; пусть
            \[
                Ku = f; \quad k\tilde{u} = \tilde f; \quad \tilde{f} = f + \delta f; \quad \tilde{u} = u + \delta u,
            \]
            причём $\|\delta f\| < \varepsilon$. Функция $\delta u$ удовлетворяет уравнению $K\delta u = \delta f$. Решение должно выглядеть как
            \[
                \delta u = \sum\limits_{i = 1}^{\infty} \dfrac{\delta f_i}{\lambda_i}\varphi_i.
            \]
            Даже если этот ряд сходится, нельзя гарантировать, что при $\varepsilon \to 0$ $\delta u$ тоже будет стремиться к нулю. 

            Действительно, всегда можно выбрать $\delta f = \varepsilon \varphi_n$, где $n$ таково, что $\lambda_n < \varepsilon$. Тогда $\|\delta u\|$ будет больше $1$.
        \end{proof}

        Подробнее про это можно прочитать в книге \cite{bahvalov}.
    \end{st}

    \paragraph{Условная корректность по Тихонову, метод квазирешений}

    \begin{thm}(об условной корректности)
        Пусть оператор $A$ на гильбертовом пространстве $H$ некорректен, но инъективен (устанавливает взаимно однозначное отображение на образ). Рассмотрим компакт $L \in H$, пусть $M$~--- его образ. Отображение $A^{-1}$ непрерывно на $M$\footnote{На самом деле это просто стандартная теорема про то, что непрерывное отображение из компактного пространства в хаусдорфово является гомеоморфизмом на образ.}.
        \begin{proof}
            Возьмём какую-нибудь последовательность $f_n \to f$ в $M$. Оператор $A$ инъективен, поэтому элементы $u_n$ такие, что $Au_n = f_n$ определены однозначно. Выберем в $\{u_n\}$ какую-нибудь сходящуюся подпоследовательность $u_n' \to u'$. 

            Поскольку оператор $A$ непрерывен, $Au_n' \to Au'$; но $Au_n' \to f$, поэтому и $Au' = f \so u' = A^{-1}f$. Но тогда выходит, что пределы всех сходящихся подпоследовательностей в $\{u_n\}$ одинаковы! Поэтому все частичные пределы совпадают, и $u_n$ имеет предел, который равен $A^{-1}f$, что и даёт нам непрерывность. 
        \end{proof}
    \end{thm}

    \begin{de}
        Это свойство~--- иметь непрерывный обратный на образах компактов~--- и называется \ti{условной корректностью}.
    \end{de}

    Пусть мы решаем задачу $Au = f$, причём правая часть известна с погрешностью:
    \[
        \|f - f_{\delta}\| \leqslant \delta,
    \]
    но уравнение $Au = f_{\delta}$ не всегда имеет решение даже когда $f_{\delta}$ из этого шара. Приходим к определению \ti{квазирешения}:

    \begin{de}
        Зафиксируем конкретную $f_{\delta}$. Тогда \ti{квазирешением} уравнения $Au = f_{\delta}$ называется вектор $u_{\delta}$, при котором достигается 
        \[
            \min\limits_{u \in D} \|Au - f_{\delta}\|, \quad D = \big\{u \, \big| \, \|u\| \leqslant R\big\}.
        \]
    \end{de}
    
    %unsure
    Если искать не при $\|u\| \leqslant R$, а при $\|u\| = R$, получится задача на условный экстремум.
    %unsure

    Используя метод множителей Лагранжа, будем минимизировать функционал
    \[
        F(u) = \alpha \|u\|^2 + \|Au - f_{\delta}\|^2.
    \]
    \begin{st}
        Минимум этого функционала удовлетворяет уравнению
        \[
            (\alpha I + A^* A)u = A^* f.
        \]
        \begin{proof}
            Обычный поиск вариации, нужно расписать $F(u + th)$ через скалярные произведения, продифференцировать по $t$, а после положить $t$ равным нулю.
        \end{proof}
    \end{st}

    Мы получили уравнение, похожее на исходное, но оно уже второго типа, а при малых $\alpha$ похоже на исходное. Произошла \ti{регуляризация}! Более того, оператор $\alpha I + A^*A$ самосопряжён, и

    \[
        \big((\alpha I + A^*A)u, \, u\big) = \alpha(u, \, u) + (Au, \, Au) \geqslant \alpha(u, \, u),
    \]
    поэтому применим вариационный принцип.

    % \begin{rem}
    %     Насколько я понимаю, метод квазирешений нам рассказан в основном для того, чтобы прийти к регуляризации. Из квазирешений следует, что при некотором $\alpha$ минимум функционала должен хорошо приближать решение~--- мотивация! Плюс демонстрация того, что не совсем очевидно, что альфу можно просто к нулю стремить.
    % \end{rem}


\paragraph{Метод регуляризации для уравнения I рода, сходимость}

    % \begin{rem}
    %     Кажется, этого билета почти нет у Оли, поэтому я опускаю доказательства. Это хорошо написано у Ангелины.
    % \end{rem}

    \begin{rem}
        В этом билете доказательств нет, их надо бы дописать. Они хорошо восстанавливаются по бумажным конспектам.
    \end{rem}

    Идея регуляризации заключается в том, чтобы минимизировать функционал вида
    \[
        F(u) = \alpha \Omega(u) + \|Au - f\|^2,
    \]
    где $\Omega(u) \geqslant 0$ и множества $\Omega(u) < C$ компактны.

    \begin{rem}
        В методе квазирешений у нас получился $\Omega(u) = \|u\|^2$, для него эти множества~--- открытые шары, они совсем не компактны.
    \end{rem}

    Стандартный выбор~--- функционал

    \[
        \Omega(u) = \int\limits_a^b u'^2 \, \del t.
    \]

    Правда, при этом мы начинаем искать решение среди гладких функций.

    \begin{st}
        Для такого функционала $\Omega$ множества $\Omega(u) < C$ компактны.
        \begin{proof}
            %TODO
            Стандартное рассуждение, использующее теорему Арцела-Асколи: подмножество в пространстве непрерывных функций на отрезке компактно тогда и только тогда, когда оно равномерно ограничено и равностепенно непрернывно. Из компактности в смысле топологии пространства непрерывных функций следует компактность в смысле $L^2$-нормы.
        \end{proof}
    \end{st}

    Годятся и функционалы

    \[
        \Omega(u) = \int\limits_a^b u^{(p)^2} \, \del t, \quad \Omega(u) = \int\limits_a^b u'^2 - u^2 \, \del t.
    \]

    \begin{thm}
        Пусть $\|f - f_{\delta}\| < \delta$, и мы решаем приближённую задачу $A\tilde{u} = f_{\delta}$ вместо точной. Если $\delta$ и $\alpha$ стремятся к нулю так, что 
        \[
            \dfrac{\delta^2}{\alpha} \leqslant \gamma < \infty,
        \]
        то $\tilde{u} \to u$.
        \begin{proof}
            См. бумажный конспект.
        \end{proof}
    \end{thm}

    Коэффициент $\alpha$ обычно подбирают эмпирически: если он мал, то решение будет ближе к $\tilde{u}$, если велик, оно будет глаже... Стандартный функционал приводит к вариационной задаче
    \[
        K^*Ku - \alpha u'' = K^* f.
    \]

\end{document}
% vim:wrapmargin=3
