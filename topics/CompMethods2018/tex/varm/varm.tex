\documentclass{trlnotes}
\setlayout{hardcopy}
\usepackage{silence}
\WarningFilter{latex}{Reference}
\graphicspath{{../../img/}}

\begin{document}
    \paragraph{Вариационный принцип для уравнения с неограниченным оператором}

    \begin{de}
        \ti{Неограниченным} называется оператор $A$ на гильбертовом пространстве, определённый на его всюду плотном линейном подпространстве $\mc{D}(A)$.
    \end{de}

    Мы будем требовать от $A$ также симметричности и положительной определённости.

    \begin{de}
        Билинейная форма $(u, \, v)_A = (Au, \, v)$ называется \ti{энергетическим скалярным произведением}, норма $\|u\|_A = (u, \, u)_A$~--- \ti{энергетической нормой}. Пополнение $H_A$ пространства $\mc{D}(A)$ по энергетической норме называется \ti{энергетическим пространством}. 
    \end{de}

    \begin{rem}
        В доказательстве \ref{st:rietz-conv-1} мы видели, что
        \[
            \|u\| \leqslant k^{-1} \|u\|_A.
        \]
        Поэтому если последовательность сходится в себе по энергетической норме, то она сходится и по обычной; кофинальные последовательности тоже одинаковые и там, и там. Поэтому пополнение по энергетической норме можно рассматривать, как подмножество $H$.
    \end{rem}

    \begin{thm}(О вариационном принципе)
        Рассмотрим энергетический функционал $F(u) = (u, \, u)_A - 2(f, \, u)$.
        \begin{enumerate}
            \item $F(u)$ имеет единственный минимум $u^*$.
            \item Если $u^* \in \mc{D(A)}$, то $Au^* = f$.
            \item Если $Au_0 = f$, то $u^* = u_0$.
        \end{enumerate}
        \begin{proof}
            Рассмотрим функционал $\Phi(u) = (f, \, u)$. Он ограничен на $H_A$, поскольку
            \[
                \big|(f, \, u)\big| \leqslant \|f\| \, \|u\| \leqslant k^{-1} \|f\| \, \|y\|_A.
            \]
            По теореме Рисса он представим в виде $\Phi(u) = (u^*, \, u)_A$.
            Тогда
            \[
                F(u) = (u, \, u)_A - 2(u^*, \, u)_A = \|u - u^*\|^2 - \|u^*\|^2.
            \]
            Ясно, что минимум достигается при $u = u^*$.

            Третий пункт очевиден, ибо
            \[
                (f, \, u) = (Au_0, \, u) = (u_0, \, u)_A \so u_0 = u^*
            \]
            То же самое в обратную сторону даёт пункт 2.
        \end{proof}
    \end{thm}

    \paragraph{Метод Ритца, сходимость}

    Метод Ритца для неограниченных операторов похож на обычный. $\varphi_n$ теперь лежат в $H_A$, а в остальном~--- всё то же самое.

    \begin{thm}
        Если набор $\{\varphi_k\}$ таков (это по сути означает, что он является базисом), что
        \[
            \all v \in H \quad \all \varepsilon > 0 \quad \ex n, \, \alpha_i \, \col \; \left\|v - \sum\limits_{i = 1}^n \alpha_i \varphi_i \right\|_A < \varepsilon,
        \]
        то метод Ритца сходится, т.е. $\|u_n - u^*\|_A \to 0$.
        \begin{proof}
            Доказательство теоремы аналогично доказательству \ref{st:rietz-conv-1}. Первый абзац такой же, по сути, а дальше надо оставить только оценки, содержащие энергетическую норму.
        \end{proof}
    \end{thm}

    \paragraph{Метод Ритца для обычной краевой задачи, вид энергетического пространства, естественные граничные условия}

    Рассмотрим краевую задачу для уравнения 
    \[
        L(y)(x) = -(p(x)y')' + q(x)y = f(x)
    \]
    на отрезке $[a, \, b]$ с граничными условиями
    \begin{itemize}
        \item I типа: $y(a) = 0$, $y(b) = 0$.
        \item III типа: $y'(a) = \alpha y(a)$, $y'(b) = \beta y(b)$.
    \end{itemize}

    \begin{de}
        \ti{Классическое решение}~--- лежит в $C^2\big([a, \, b]\big)$, удовлетворяет уравнению в каждой точке. 
    \end{de}

    Ну и $\mc{D}(L) = C^2\big([a, \, b]\big)$. 

    \begin{rem}
        На самом деле, мы ищем решения не в $\mc{D}(L)$, а в более узких пространствах. В случае условия I типа нас интересует простанство
        \[
            D_{I} = \big\{y \in \mc{D}(L) \, \big| \, y(a) = y(b) = 0\big\},
        \]
        а в случае условия III типа
        \[
            D_{III} = \big\{y \in \mc{D}(L) \, \big| \, y'(a)\alpha y(a), \; y'(b) = \alpha y(b)\big\}.
        \]
        Именно их мы будем пополнять, создавая соответствующее энергетическое пространство.
    \end{rem}

    \begin{st}
        Если $\alpha \geqslant 0$ и $\beta \leqslant 0$ в добавок к условиям
        \[
            p(x) \geqslant p_0 > 0, \quad q(x) \geqslant 0,
        \]
        то оператор получится симметричный и положительно определённый.

        \begin{proof}
            Посмотрим, как будет выглядеть энергетическое скалярное произведение:

            \[
                (Ly, \, z) = \int\limits_a^b \big(-(py')' + qy\big) z \, \del x = -py'z\big|_a^b + \int\limits_a^b (py'z' + qyz) \, \del z.
            \]
            Интеграл обозначим через $I(X)$, а внеинтегральный член~--- $Q(x)$. Если условия первого типа, то $Q = 0$, а если третьего, то
            \[
                Q(y, \, z) = -\beta p(b)y(b)z(b) + \alpha p(a)y(a)z(a).
            \]
            Симметричность уже видна, и
            \[
                (Ly, \, y) = \int\limits_a^b (py'^2 + qy^2) \, \del x -\beta p(b)y(b)^2 + \alpha p(a)y(a)^2.
            \]
            Если, $\alpha \geqslant 0$ и $\beta \leqslant 0$, то и положительная определённость будет.
        \end{proof}
    \end{st}

    \begin{de}
        \ti{Пространством Соболева} $W_p^k(Q) \subset L^p(Q)$ называют пространство функций, обобщённые производные которых вплоть до $k$-й лежат в $L_p(Q)$.
    \end{de}

    \begin{rem}
        На пространствах Соболева есть норма. Нас будет интересовать пространство $W_2^1\big([a, \, b]\big)$; на нём эта норма имеет вид
        \[
            \|f\|^2_{W_2^1} = \int\limits_a^b (f^2 + f'^2) \, \del x.
        \]
        Можно доказать, что с такой нормой является гильбертовым (а произвольные пространства Соболева~--- банаховы). 
    \end{rem}

    \begin{st}
        Энергетическая норма для оператора $L$ эквивалентна норме в $W_2^1$.
        \begin{proof}
            Пусть $P_m = \max p$, $Q_m = \max q$, $M = \max(P_m, \, Q_m)$. Нетрудно доказывается, что $\|y\|_{W_2^1} \leqslant C \|y\|_L$:
            \[
                \int\limits_a^b (f^2 + f'^2) \, \del x \leqslant \dfrac{1}{M} \int\limits_a^b (pf^2 + qf'^2) \, \del x \leqslant \dfrac{1}{M} \|f\|_L.
            \]
            Обратное утверждение очевидно для I типа граничных условий:
            \[
                \int\limits_a^b (pf^2 + qf'^2) \, \del x \leqslant M \|f\|_{W_2^1}.
            \]
            Чтобы разобраться с граничными условиями III типа, нам понадобится лемма:
            \begin{lm}
                Для любой точки $x$ значение $y(x)^2$ не превосходит константы, умноженной на $\|y\|_{W_2^1}^2$.
                \begin{proof}
                    Ограничение соболевской нормы даёт ограничение на интеграл от квадрата функции + не позволяет ей расти слишком быстро, поэтому есть надежда, что значения и правда будут ограничены нормой. Займёмся оценкой. Очевидно, что
                    \[
                        y(x) = y(\xi) + \int\limits_{\xi}^x y(t) \, \del t.
                    \]
                    Поскольку $(a + b)^2 \leqslant 2(a^2 + b^2)$,
                    \[
                        y(x)^2 \leqslant 2y(\xi)^2 + 2 \left(\,\int\limits_{\xi}^x y'(t) \, \del t\right)^2.
                    \]
                    При этом интеграл
                    \[
                        \int\limits_{\xi}^x y'(t) \, \del t
                    \]
                    является $L^2$-произведением (в отрезке от $\xi$ до $x$) $\big(y'(t), \, 1\big)_{L^2}$, и
                    \[
                        \big(y'(t), \, 1\big)_{L^2}^2 \leqslant \|1\|_{L^2([x, \, \xi])}^2 \,\|y'\|_{L^2([x, \, \xi])}^2 = (x - \xi) \int\limits_{\xi}^x y'(t)^2 \, \del t \leqslant (b - a)\|y'\|^2_{L^2}
                    \]
                    В итоге получаем, что
                    \[ 
                        y(x)^2 \leqslant 2y(\xi)^2 + 2(b - a) \|y'\|^2_{L^2}
                    \]
                    Навесив слева и справа интегралы по $\xi$, получим, что
                    \[
                        y(x)^2 \leqslant \dfrac{2}{b - a} \|y\|^2_{L^2} + 2(b - a) \|y'\|^2_{L^2} \leqslant C \|y\|^2_{W_2^1}.
                    \]
                \end{proof}
            \end{lm}
            Используя полученную оценку, нетрудно оценить отвечающий за граничные условия член $Q(x)$ через соболевскую норму.
        \end{proof}
    \end{st}

    \begin{rem}
        Ещё выполняется \ti{теорема вложения}: все функции из $W_2^1$ непрерывны, при этом отображение вложения $W_2^1 \to C\big([a, \, b]\big)$ непрерывно.
    \end{rem}

    \begin{st}
        Энергетическое пространство $H_{L}$ является подпространством в $W_2^1$.
        \begin{proof}
            Не очень важно, $D_{I}$ или $D_{III}$ придётся пополнять: они оба лежат в $\mc{D}(L)$, про которое мы доказали, что с энергетической нормой оно гомеоморфно вкладывается в $W_2^1$. Поскольку $W_2^1$ гильбертово, пополнение нас из него не выведет.
        \end{proof}
    \end{st}

    \begin{rem}
        Пополнение пространства $D_I$ приведёт нас к пространству $\overset{\circ}{W_1^2}$ элементов $W_1^2$, удовлетворяющих граничному условию I типа. С условием III так не получится, поскольку
        %unsure
        производная~--- не непрерывный функционал, и мы придём ко всему $W_1^2$.
        %unsure
        По этой причине условия I типа называют \ti{главными}, а III типа~--- \ti{естественными}.
    \end{rem}

    О пространствах Соболева в контексте вычислительных методов можно прочитать в книге \cite{lebedev}, и ещё подробнее в книге \cite{atkinson}.

    \paragraph{ВРМ-1 для обычной краевой задачи}

    Идея \ti{вариационно-разностных методов} заключается в том, чтобы использовать сетку и минимизацию функционала одновременно. 

    Пусть в сетке $n$ элементов, $h = \dfrac{b - a}{n}$, $x_k = a + k h$; рассмотрим пространство, состоящее из сеточных функций $y_{(n)} = \{y_k\}_0^n$. Суть ВРМ-1 в том, чтобы заменить интегралы на суммы, а производные~--- на разности, и минимизировать функционал на сеточных функциях.

    Наш функционал имеет вид
    \[
        F(y) = (y, \, y)_L - 2(f, \, y) = \int\limits_a^b (py'^2 + qy^2 - 2fy) \, \del x - \beta p(b)y^2(b) + \alpha p(a)y^2(a). 
    \]

    Сделаем численные замены:
    \begin{align*}
        &\int\limits_a^b py' \, \del x \approx h \sum\limits_{k = 0}^{n - 1} p\left(x_k + \dfrac{h}{2} \right) \cdot \left(\dfrac{y_{k + 1} - y_k}{h}\right)^2; \\ 
        &\int\limits_a^b (qy^2 - 2fy) \, \del x \approx k\sum\limits_{k = 0}^{n - 1}\,\!^{'} (q_ky_k^2 - 2f_ky_k),
    \end{align*}
    где сумма со штрихом означает, что это формула трапеций (т.е. крайние слагаемые домножены на $\nicefrac{1}{2}$).

    Не представляет труда теперь выписать сеточный функционал. Далее минимум ищется дифференцированием по $y_k$ и приравниванием всех производных к нулю. В итоге для внутренних точек получаются уравнения
    \[
        -\dfrac{1}{h}\left(p_{i + \tfrac{1}{2}} \dfrac{y_{i + 1} - y_i}{h} - p_{i - \tfrac{1}{2}} \dfrac{y_i - y_{i - 1}}{h}\right) + q_i y_i = f_i.
    \]
    Они напоминают уравнения разностной прогонки.
    %unsure на них бы сослаться

    Для левого конца получится уравнение
    \[
        -p_{\frac{1}{2}} \dfrac{y_1 - y_0}{2} + \dfrac{h}{2}(q_0 y_0 - f_0) + \alpha p_0 y_0 = 0
    \]
    Второе слагаемое неожиданное! Ведь здесь стоило ожидать простейшее приближение $y'(a) = \alpha y(a)$. Оказывается, что оно компенсирует сдвиг:
    \begin{align*}
        p_{\frac{1}{2}} \dfrac{y_1 - y_0}{2} &= [py']\left(a + \dfrac{h}{2}\right) + O(h^2)  = \\ &= p(a)y'(a) + \dfrac{h}{2}(py')'|_a + O(h^2) = \\ &= p(a)y'(a) + \dfrac{h}{2} \big(q(a)y(a) - f(a)\big) + O(h^2). 
    \end{align*}

    \paragraph{ВРМ-2 для обычной краевой задачи}

    Идея ВРМ-2 заключается в том, чтобы <<поднять>> сеточные функции до каких-нибудь функций из $W_2^1$  (с помощью некоторого сорта интерполяции), а потом минимизировать функционал на получившемся пространстве. 

    Будем работать с граничными условиями I типа.

    Используем кусочно-линейную интерполяцию:
    \[
        \tilde{y}_{(n)}(x) = \dfrac{x_{k + 1} - x}{h} y_k + \dfrac{x - x_k}{h}y_{k + 1}.
    \]
    Производная определена всюду, кроме узлов:
    \[
        \tilde{y}_{(n)}'(x) = \dfrac{y_{k + 1} - y_k}{h}.
    \]

    %unsure
    Однако узлы~--- множество меры ноль, поэтому производная всё равно определена, как обобщённая функция. Можно доказать, что это и будет производная в смысле обобщённых функций от восполненной сеточной функции. Поэтому наши восполненные функции находятся в $W_2^1$.
    %unsure

    Можно ввести базисные функции~--- это восполнения сеточных функций, которые равны нулю всюду, кроме одной точки, а в ней равны единица, т.е.
    \[
        \psi_k(x) = \begin{cases}
            \dfrac{x_{k + 1} - x}{h}, \; [x_k, \, x_{k + 1}]; \\ 
            \dfrac{x - x_{k - 1}}{h}, \; [x_{k - 1}, \, x_k]; \\
            0.
        \end{cases}
    \]

    Получилось что-то очень похожее на метод Ритца, но только теперь у нас не фиксированный бесконечный набор $\{\varphi_k\}$, а для каждого $n$ есть набор $\{\psi_k\}$ с понятным геометрическим смыслом.

    Уравнение для минимизации получится такое же:
    \[
        \sum\limits_{k = 1}^{n - 1}(\psi_k, \, \psi_m)_A y_k = (f, \, \psi_m),
    \]
    матрица системы~--- $\{a_{km}\} = (\psi_k, \, \psi_m)_A$.

    Носители базисных функций почти не пересекаются, поэтому
    \[
        |k - m| > 1 \so a_{km} = 0.
    \]
    Поэтому система уравнений снова выходит трёхдиагональной:
    \[
        a_m y_{m - 1} + b_m y_m + a_{m + 1} y_{m + 1} = (f, \, \psi_m),
    \]
    где
    \[
        a_m = a_{m-1, \, m} \text{ и } b_m = a_{mm}.
    \]

    %unsure
    На негладких решениях мы не получим точности лучше, чем $O(h)$. Однако этот метод для них надёжнее, чем просто сеточный.
    %unsure

    \paragraph{Метод Ритца для эллиптического уравнения, энергетическое пространство и естественные условия}

    Рассмотрим уравнение
    \[
        Lu = - \sum\limits_{i = 1}^n \dfrac{\pd}{\pd x_i}\left(a_{ik} \dfrac{\pd u}{\pd x_k}\right) + au = f.
    \]

    Коэффициенты должны удовлетворять нескольким условиям:

    \begin{enumerate}
        \item Все функции действуют в области $\Omega \subset \R^n$. В классическом сеттинге решение считается дважды непрерывно дифференцируемыми в $\Omega$ и непрерывным на $\ov{-}{\Omega}$; $a_{ij}$~--- один раз непрерывно дифференцируемы на $\ov{-}{\Omega}$, а остальные коэффициенты просто непрерывны.
        \item Симметричность (эллиптичность): $a_{ik}(x) = a_{ki}(x)$.
        \item Положительная определённость:
        \[
            \sum\limits_i \sum\limits_k a_{ik} \xi_i \xi_k \geqslant k^2 \sum\limits_i \xi_i^2.
        \]
    \end{enumerate}

    Граничные условия бывают
    \begin{enumerate}
        \item $u|_{\pd\Omega} = 0$~--- I типа (задача Дирихле).
        \item Пусть
        \[
            \dfrac{\pd u}{\pd \nu} \bigg|_{\pd \Omega} = \sum\limits_{i = 1}^n a_{ij} \cos(n, \, x_i) \dfrac{\pd u}{\pd x_i} \bigg|_{\pd \Omega}.
        \]
        Этот оператор называется \ti{конормальной производной}.
        Тогда граничное условие выглядит, как
        \[
            \dfrac{\pd u}{\pd \nu} = \sigma u|_{\pd \Omega}.
        \]
        Это~--- задача третьего рода (задача Фон-Неймана).
        \item Задача второго рода~--- когда $\sigma = 0$.
    \end{enumerate}

    Найдём вид энергетического произведения.

    \begin{st}
        \[
            (Lu, \, v) = \int\limits_{\Omega} \left(\sum\limits_{i, \, j = 1}^n a_{ij} \dfrac{\pd u}{\pd x_j} \dfrac{\pd v}{\pd x_i} + auv\right) \pd x + \int\limits_{\pd \Omega} \sigma u v \, \del S.
        \]
        \begin{proof}
            \[
                (Lu, \, v) = \int\limits_{\Omega}  \left( - \sum\limits_{i = 1}^n \dfrac{\pd}{\pd x_i}\left(a_{ik} \dfrac{\pd u}{\pd x_k}\right) + au \right) v \, \del x
            \]
            Используя формулу интегрирования по частям
            \[
                \int\limits_{\Omega} \dfrac{\pd u}{\pd x_i} \varphi \, \del x = - \int\limits_{\Omega} u  \dfrac{\pd \varphi}{\pd x_i} \, \del x + \int\limits_{\pd \Omega} u\varphi \cos(n, \, x_i) \, \del S,
            \]
            найдём искомый результат.
        \end{proof}
    \end{st}

    \begin{st}
        $\hphantom{.}$
        Оператор положительно определён, если
        \begin{enumerate}
            \item Задача первого типа: $a(x) \geqslant 0$;
            \item Задача второго типа: $a(x) \geqslant a_0 > 0$;
            \item Задача третьего типа: $a(x) \geqslant a_0 > 0$, $\sigma(x) \geqslant 0$ или $a(x) \geqslant 0$, $\sigma(x) \geqslant \sigma_0 > 0$.
        \end{enumerate}
        \begin{proof}
            \[
                (Lu, \, u) = \int\limits_{\Omega} \left(\sum\limits_{i, \, j = 1}^n a_{ij} \dfrac{\pd u}{\pd x_j} \dfrac{\pd u}{\pd x_i} + au^2\right) \pd x + \underbrace{\int\limits_{\pd \Omega} \sigma u^2 \, \del S}_{\text{III}}.
            \]
            Нам понадобится неравенство Фридрихса 
            \[
                \int\limits_{\Omega} u^2 \, \del x \leqslant c_1 \left(\;\int\limits_{\Omega} \sum \left(\dfrac{\pd u}{\pd x_i}\right)^2 \, \del x + \int\limits_{\pd \Omega} u^2 \, \del S \right).
            \]
            \begin{enumerate}
                \item Здесь работает совсем грубая оценка:
                \[
                    \int\limits_{\Omega} \left(\sum\limits_{i, \, j = 1}^n a_{ij} \dfrac{\pd u}{\pd x_j} \dfrac{\pd u}{\pd x_i} + au^2\right) \pd x \geqslant \int\limits_{\Omega} \sum\limits_{i, \, j = 1}^n a_{ij} \dfrac{\pd u}{\pd x_j} \dfrac{\pd u}{\pd x_i} \pd x \geqslant k^2 \int\limits_{\Omega} \sum\limits_{i = 1}^n \left(\dfrac{\pd u}{\pd x_j}\right)^2\pd x \geqslant \dfrac{k^2}{c_1} \int\limits_{\Omega} u^2 \, \del x.
                \]
                \item 
                Ещё проще, как это ни странно.
                \[
                    \int\limits_{\Omega} \left(\sum\limits_{i, \, j = 1}^n a_{ij} \dfrac{\pd u}{\pd x_j} \dfrac{\pd u}{\pd x_i} + au^2\right) \pd x \geqslant a_0\int\limits_{\Omega} u^2 \, \del x
                \]
                \item Первый вариант доказывается точно так же, как для II типа, а второй:
                \[
                    \int\limits_{\Omega} \left(\sum\limits_{i, \, j = 1}^n a_{ij} \dfrac{\pd u}{\pd x_j} \dfrac{\pd u}{\pd x_i} + au^2\right) \pd x + \int\limits_{\pd \Omega} \sigma u^2 \, \del S \geqslant k^2 \int\limits_{\Omega} \sum\limits_{i = 1}^n \left(\dfrac{\pd u}{\pd x_j}\right)^2\pd x + \sigma_0 \int\limits_{\pd \Omega} u^2 \, \del S \geqslant \dfrac{\min(k^2, \, \sigma_0)}{c_1} \int\limits_{\Omega} u^2 \, \del x.
                \]
            \end{enumerate}
        \end{proof}
    \end{st}

    \begin{rem}
        Можно доказать, что эта энергетическая норма эквивалентна норме в $W_2^1(\Omega)$:
        \[
            \|v\|_{W_2^1}^2 = \int\limits_{\Omega} \left(\sum \left(\dfrac{\pd u}{\pd x_i}\right)^2 + u^2 \right) \, \del x.
        \]
        Энергетическое пространство для II и III типов совпадёт с $W_2^1$, а для типа I унаследует граничное условие и будет состоять из элементов $W_2^1$, обращающихся в ноль на границе.
    \end{rem}

    \begin{rem}
        Вообще всё это очень похоже на обычную краевую задачу, только многомерную. При подборе базиса $\{\varphi_k\}$ для метода Ритца в задаче I типа нужно как-то заставить $\varphi_k$ обращаться в ноль на границе области $\Omega$, которая может быть некрасивой. Чтобы это сделать, можно найти функцию $\omega(x, \, y)$~--- это на плоскости~--- которая положительна в $\Omega$ и равна нулю на границе. Читатель сможет придумать такие функции для квадрата/круга/сектора круга, но вообще это, видимо, искусство.
    \end{rem}

    По поводу этого билета стоит заглянуть в книгу \cite{lebedev}.

\end{document}
% vim:wrapmargin=3
